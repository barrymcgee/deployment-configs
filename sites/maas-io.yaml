name: maas-io
domain: maas.io

container:
  image: prod-comms.docker-registry.canonical.com/maas.io

useSquid: true

envSecrets:
  - name: SENTRY_DSN
    value: https://66c89fd7773e4b408d3e25867d6899e9@sentry.is.canonical.com//6

  - name: SEARCH_API_KEY
    secretKeyRef:
      key: google-custom-search-key
      name: google-api

# Overrides for production
production:
  extraHosts:
    - host:
      - docs.maas.io
      tlsSecret: docs-maas-io-tls

  nginxConfig:  |
    if ($host = 'docs.maas.io' ) {
      rewrite ^ https://maas.io/docs$request_uri? permanent;
    }
    if ($host != 'maas.io' ) {
      rewrite ^ https://maas.io$request_uri? permanent;
    }
    more_set_headers "Link: <https://assets.ubuntu.com>; rel=preconnect; crossorigin, <https://assets.ubuntu.com>; rel=preconnect";

# Overrides for staging
staging:
  wwwPrefixHost: false

  extraHosts:
    - host:
      - docs.staging.maas.io
      tlsSecret: docs-staging-maas-io-tls

  nginxConfig:  |
    if ($host = 'docs.staging.maas.io' ) {
      rewrite ^ https://staging.maas.io/docs$request_uri? permanent;
    }
    more_set_headers "X-Robots-Tag: noindex";
    more_set_headers "Link: <https://assets.ubuntu.com>; rel=preconnect; crossorigin, <https://assets.ubuntu.com>; rel=preconnect";
